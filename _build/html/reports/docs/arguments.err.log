Traceback (most recent call last):
  File "/usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages/nbclient/client.py", line 1314, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
  File "/usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages/nbclient/client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "/usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
! pip3 install dash
! pip install dash

import pandas as pd
import numpy as np
import dash
from dash import dcc, html
from dash.dependencies import Input, Output
import plotly.graph_objs as go
import plotly.express as px

# makeing a dataframe with the data of two separate datasets of the amount of crimes per country, per year. 
# Most values align, but some are missing in one dataset and not in the other
# To make the dataframe as complete as possible, we'll combine the two datasets

crimes_1 = pd.read_csv("DLOs_europe_1.csv")
crimes_2 = pd.read_csv("DLOs_europe_2.csv")

crimes_df1 = pd.DataFrame(crimes_1)
crimes_df2 = pd.DataFrame(crimes_2)

years = ['2022','2021','2020','2019','2018','2017','2016','2015','2014','2013','2012','2011','2010','2009','2008','2007']

# Function to compare values from the two dataframes and return a combined value
def compare_values(self_value, other_value):

    # if both are Nan, keep Nan in the dataset
    if pd.isna(self_value) and pd.isna(other_value):
        return np.nan

    # if one value is NaN, keep the value of the other dataset
    elif pd.isna(self_value):
        return other_value
    elif pd.isna(other_value):
        return self_value
    
    # if values are the same
    elif self_value == other_value:
        return self_value

    # if values are different, keep the mean
    else:
        return (self_value + other_value) / 2

# Create a new dictionary to store the combined data from the two dataframes
combined_crimes = {'Country': crimes_df1['Country']}

# Loop through each year to process the data for that year
for year in years:

    # Check if the year exists in both dataframes
    if year in crimes_df1.columns and year in crimes_df2.columns:
        
        # For each row, apply a the compare_values() function to compare and combine the values from both dataframes
        combined_crimes[year] = crimes_df1.apply(
            lambda row: compare_values(

                # Value from the first dataframe
                row[year], 

                # Corresponding value from the second dataframe
                crimes_df2.loc[crimes_df2['Country'] == row['Country'], year].values[0]

                # Use np.nan if the country is not in the second dataframe
                if row['Country'] in crimes_df2['Country'].values else np.nan 

            ), axis=1
        )
        
    # If the year exists only in the first dataframe, use those values
    elif year in crimes_df1.columns:
        combined_crimes[year] = crimes_df1[year]

    # Same for the second dataframe
    elif year in crimes_df2.columns:
        combined_crimes[year] = crimes_df2[year]

    # If the year exists in neither dataframe, use np.nan
    else:
        combined_crimes[year] = np.nan

# Convert the dictionary to a DataFrame
crimes_combined_df = pd.DataFrame(combined_crimes)


# Making a dataframe for amount of crimes per 1000 inhabitants

inhabitants = pd.read_csv("Population_europe.csv")
inhabitants_df = inhabitants[['Country Name'] + years].copy()
inhabitants_df.rename(columns={'Country Name': 'Country'}, inplace=True)

# Function to calculate the number of crimes per 1000 inhabitants
def calc_per_100_inhabitants(row, year):
    if pd.isna(row[f'{year}']):
        return np.nan
    else:
        return round(row[f'{year}'] / (inhabitants_df.at[row.name, f'{year}'] / 1000), 3)

# Create a new DataFrame with the crime data per 1000 inhabitants
per_inhabitants_df = crimes_combined_df.copy()

for year in years:
    if year in crimes_combined_df.columns and year in inhabitants_df.columns:
        per_inhabitants_df[year] = crimes_combined_df.apply(lambda row: calc_per_100_inhabitants(row, year), axis=1)

per_inhabitants_df.reset_index(drop=True, inplace=True)

# make interactive barplot

app2 = dash.Dash(__name__)

# html layout of the Dash application
app2.layout = html.Div([
    html.H1("Comparison of the amount of drug crimes per year in portugal and other countries"),

    html.Label("Select countries (Portugal is always included):"),
    dcc.Dropdown(
        id='country-selector',
        options=[{'label': i, 'value': i} for i in crimes_combined_df['Country'].unique() if i != 'Portugal'],
        value=['France', 'Spain'], 
        multi=True
    ),

    html.Label("Selecteer Jaren:"),
    dcc.Dropdown(
        id='year-selector',
        options=[{'label': i, 'value': i} for i in crimes_combined_df.columns if i != 'Country'],
        value=['2021', '2017','2012', '2007'], 
        multi=True
    ),
    html.Label("Select Scale:"),
    dcc.Dropdown(
        id='scale-selector',
        options=[
            {'label': 'Linear', 'value': 'linear'},
            {'label': 'Logarithmic', 'value': 'log'}
        ],
        value='log', 
    ),
    html.Label("Select unit:"),
    dcc.Dropdown(
        id='data-selector',
        options=[
            {'label': 'Totaal amount of cases', 'value': 'total'},
            {'label': 'cases/1000 inhabitants', 'value': 'per_inhabitants'}
        ],
        value='total', 
    ),
    dcc.Graph(id='bar-plot'),
    html.Div(id='missing-data-warning', style={'color': 'red', 'margin-top': '20px'})
], style={'backgroundColor': 'lightgrey', 'padding': '20px'})

# Define the callback to update the graph and warning text
@app2.callback(
    [Output('bar-plot', 'figure'), Output('missing-data-warning', 'children')],
    [Input('country-selector', 'value'),
     Input('year-selector', 'value'),
     Input('scale-selector', 'value'),
     Input('data-selector', 'value')]
)

def update_graph(selected_countries, selected_years, selected_scale, selected_data):
    selected_countries.append('Portugal') 

    # Choose the correct dataset based on the selected data type
    filtered_df = per_inhabitants_df if selected_data == 'per_inhabitants' else crimes_combined_df

    # Filter the dataframe based on the selected countries and years
    selected_countries_df = filtered_df[filtered_df['Country'].isin(selected_countries)].copy()
    final_df = selected_countries_df.melt(id_vars=['Country'], value_vars=selected_years, var_name='Year', value_name='Cases')
    
    # make sure Portugal is always the first country in the plots
    country_order = ['Portugal'] + sorted([c for c in selected_countries if c != 'Portugal'])
    
    bars = []
    missing_data_info = []
    warning_text = ""

    # Loop through each country to create bar plots and track missing data
    for country in country_order:
        country_data = final_df[final_df['Country'] == country]
        bars.append(go.Bar(
            x=country_data[pd.notna(country_data['Cases'])]['Year'],
            y=country_data[pd.notna(country_data['Cases'])]['Cases'],
            name=country
        ))

        nan_data = country_data[pd.isna(country_data['Cases'])]
        if not nan_data.empty:
            missing_data_info.append(f"{country} ({', '.join(nan_data['Year'])})")
    
    fig = go.Figure(data=bars)
    fig.update_layout(
        paper_bgcolor='lightgrey',
        plot_bgcolor='white', 
        font=dict(color='black'),  
        yaxis_type=selected_scale,
        title= "Amount of drug crimes per year for the selected years and countries",
        xaxis_title="Year", 
        yaxis_title= "Number of Crimes" if selected_data == 'total' else "Crimes per 1000 Inhabitants"
    )

    # Generate the warning text for missing data
    warning_text = ""
    if missing_data_info:
        warning_text = "Please note that the following countries/years contain missing data: " + "; ".join(missing_data_info)
    
    return fig, warning_text

# Run the Dash application
if __name__ == '__main__':
    # app.run_server(debug=True)
    app2.run_server(debug=True, port=8051) 
------------------

----- stdout -----
Requirement already satisfied: dash in /usr/local/lib/python3.11/site-packages (2.17.1)
----- stdout -----
Requirement already satisfied: Flask<3.1,>=1.0.4 in /usr/local/lib/python3.11/site-packages (from dash) (3.0.3)
Requirement already satisfied: Werkzeug<3.1 in /usr/local/lib/python3.11/site-packages (from dash) (3.0.3)
Requirement already satisfied: plotly>=5.0.0 in /usr/local/lib/python3.11/site-packages (from dash) (5.22.0)
Requirement already satisfied: dash-html-components==2.0.0 in /usr/local/lib/python3.11/site-packages (from dash) (2.0.0)
Requirement already satisfied: dash-core-components==2.0.0 in /usr/local/lib/python3.11/site-packages (from dash) (2.0.0)
Requirement already satisfied: dash-table==5.0.0 in /usr/local/lib/python3.11/site-packages (from dash) (5.0.0)
Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.11/site-packages (from dash) (7.2.0)
Requirement already satisfied: typing-extensions>=4.1.1 in /usr/local/lib/python3.11/site-packages (from dash) (4.12.2)
Requirement already satisfied: requests in /usr/local/lib/python3.11/site-packages (from dash) (2.31.0)
Requirement already satisfied: retrying in /usr/local/lib/python3.11/site-packages (from dash) (1.3.4)
Requirement already satisfied: nest-asyncio in /usr/local/lib/python3.11/site-packages (from dash) (1.6.0)
Requirement already satisfied: setuptools in /usr/local/lib/python3.11/site-packages (from dash) (69.0.2)
Requirement already satisfied: Jinja2>=3.1.2 in /usr/local/lib/python3.11/site-packages (from Flask<3.1,>=1.0.4->dash) (3.1.3)
Requirement already satisfied: itsdangerous>=2.1.2 in /usr/local/lib/python3.11/site-packages (from Flask<3.1,>=1.0.4->dash) (2.2.0)
Requirement already satisfied: click>=8.1.3 in /usr/local/lib/python3.11/site-packages (from Flask<3.1,>=1.0.4->dash) (8.1.7)
Requirement already satisfied: blinker>=1.6.2 in /usr/local/lib/python3.11/site-packages (from Flask<3.1,>=1.0.4->dash) (1.8.2)
Requirement already satisfied: tenacity>=6.2.0 in /usr/local/lib/python3.11/site-packages (from plotly>=5.0.0->dash) (8.3.0)
Requirement already satisfied: packaging in /usr/local/lib/python3.11/site-packages (from plotly>=5.0.0->dash) (23.2)
Requirement already satisfied: MarkupSafe>=2.1.1 in /usr/local/lib/python3.11/site-packages (from Werkzeug<3.1->dash) (2.1.5)
Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.11/site-packages (from importlib-metadata->dash) (3.19.2)
----- stdout -----
Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.11/site-packages (from requests->dash) (3.3.2)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.11/site-packages (from requests->dash) (3.6)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.11/site-packages (from requests->dash) (2.2.1)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.11/site-packages (from requests->dash) (2024.2.2)
Requirement already satisfied: six>=1.7.0 in /usr/local/lib/python3.11/site-packages (from retrying->dash) (1.16.0)
----- stdout -----

[1m[[0m[34;49mnotice[0m[1;39;49m][0m[39;49m A new release of pip is available: [0m[31;49m23.3.1[0m[39;49m -> [0m[32;49m24.1[0m
[1m[[0m[34;49mnotice[0m[1;39;49m][0m[39;49m To update, run: [0m[32;49m/usr/local/opt/python@3.11/bin/python3.11 -m pip install --upgrade pip[0m
----- stdout -----
Requirement already satisfied: dash in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (2.17.1)
----- stdout -----
Requirement already satisfied: Flask<3.1,>=1.0.4 in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from dash) (3.0.3)
Requirement already satisfied: Werkzeug<3.1 in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from dash) (3.0.3)
Requirement already satisfied: plotly>=5.0.0 in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from dash) (5.22.0)
Requirement already satisfied: dash-html-components==2.0.0 in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from dash) (2.0.0)
Requirement already satisfied: dash-core-components==2.0.0 in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from dash) (2.0.0)
Requirement already satisfied: dash-table==5.0.0 in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from dash) (5.0.0)
Requirement already satisfied: importlib-metadata in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from dash) (7.1.0)
Requirement already satisfied: typing-extensions>=4.1.1 in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from dash) (4.12.1)
Requirement already satisfied: requests in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from dash) (2.32.3)
Requirement already satisfied: retrying in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from dash) (1.3.4)
Requirement already satisfied: nest-asyncio in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from dash) (1.6.0)
Requirement already satisfied: setuptools in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from dash) (69.5.1)
Requirement already satisfied: Jinja2>=3.1.2 in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from Flask<3.1,>=1.0.4->dash) (3.1.4)
Requirement already satisfied: itsdangerous>=2.1.2 in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from Flask<3.1,>=1.0.4->dash) (2.2.0)
Requirement already satisfied: click>=8.1.3 in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from Flask<3.1,>=1.0.4->dash) (8.1.7)
Requirement already satisfied: blinker>=1.6.2 in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from Flask<3.1,>=1.0.4->dash) (1.8.2)
Requirement already satisfied: tenacity>=6.2.0 in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from plotly>=5.0.0->dash) (8.3.0)
Requirement already satisfied: packaging in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from plotly>=5.0.0->dash) (24.0)
----- stdout -----
Requirement already satisfied: MarkupSafe>=2.1.1 in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from Werkzeug<3.1->dash) (2.1.5)
Requirement already satisfied: zipp>=0.5 in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from importlib-metadata->dash) (3.17.0)
Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from requests->dash) (3.3.2)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from requests->dash) (3.7)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from requests->dash) (2.2.1)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from requests->dash) (2024.2.2)
Requirement already satisfied: six>=1.7.0 in /usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages (from retrying->dash) (1.16.0)
----- stderr -----
Address already in use
Port 8051 is in use by another program. Either identify and stop that program, or start the server with a different port.
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mOSError[0m                                   Traceback (most recent call last)
File [0;32m/usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages/werkzeug/serving.py:750[0m, in [0;36mBaseWSGIServer.__init__[0;34m(self, host, port, app, handler, passthrough_errors, ssl_context, fd)[0m
[1;32m    749[0m [38;5;28;01mtry[39;00m:
[0;32m--> 750[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mserver_bind[49m[43m([49m[43m)[49m
[1;32m    751[0m     [38;5;28mself[39m[38;5;241m.[39mserver_activate()

File [0;32m/usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/http/server.py:137[0m, in [0;36mHTTPServer.server_bind[0;34m(self)[0m
[1;32m    136[0m [38;5;250m[39m[38;5;124;03m"""Override server_bind to store the server name."""[39;00m
[0;32m--> 137[0m [43msocketserver[49m[38;5;241;43m.[39;49m[43mTCPServer[49m[38;5;241;43m.[39;49m[43mserver_bind[49m[43m([49m[38;5;28;43mself[39;49m[43m)[49m
[1;32m    138[0m host, port [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mserver_address[:[38;5;241m2[39m]

File [0;32m/usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/socketserver.py:466[0m, in [0;36mTCPServer.server_bind[0;34m(self)[0m
[1;32m    465[0m     [38;5;28mself[39m[38;5;241m.[39msocket[38;5;241m.[39msetsockopt(socket[38;5;241m.[39mSOL_SOCKET, socket[38;5;241m.[39mSO_REUSEADDR, [38;5;241m1[39m)
[0;32m--> 466[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43msocket[49m[38;5;241;43m.[39;49m[43mbind[49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mserver_address[49m[43m)[49m
[1;32m    467[0m [38;5;28mself[39m[38;5;241m.[39mserver_address [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39msocket[38;5;241m.[39mgetsockname()

[0;31mOSError[0m: [Errno 48] Address already in use

During handling of the above exception, another exception occurred:

[0;31mSystemExit[0m                                Traceback (most recent call last)
    [0;31m[... skipping hidden 1 frame][0m

Cell [0;32mIn[1], line 213[0m
[1;32m    211[0m [38;5;28;01mif[39;00m [38;5;18m__name__[39m [38;5;241m==[39m [38;5;124m'[39m[38;5;124m__main__[39m[38;5;124m'[39m:
[1;32m    212[0m     [38;5;66;03m# app.run_server(debug=True)[39;00m
[0;32m--> 213[0m     [43mapp2[49m[38;5;241;43m.[39;49m[43mrun_server[49m[43m([49m[43mdebug[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m[43m [49m[43mport[49m[38;5;241;43m=[39;49m[38;5;241;43m8051[39;49m[43m)[49m 

File [0;32m/usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages/dash/dash.py:2277[0m, in [0;36mDash.run_server[0;34m(self, *args, **kwargs)[0m
[1;32m   2272[0m [38;5;250m[39m[38;5;124;03m"""`run_server` is a deprecated alias of `run` and may be removed in a[39;00m
[1;32m   2273[0m [38;5;124;03mfuture version. We recommend using `app.run` instead.[39;00m
[1;32m   2274[0m 
[1;32m   2275[0m [38;5;124;03mSee `app.run` for usage information.[39;00m
[1;32m   2276[0m [38;5;124;03m"""[39;00m
[0;32m-> 2277[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mrun[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages/dash/dash.py:2168[0m, in [0;36mDash.run[0;34m(self, host, port, proxy, debug, jupyter_mode, jupyter_width, jupyter_height, jupyter_server_url, dev_tools_ui, dev_tools_props_check, dev_tools_serve_dev_bundles, dev_tools_hot_reload, dev_tools_hot_reload_interval, dev_tools_hot_reload_watch_interval, dev_tools_hot_reload_max_retry, dev_tools_silence_routes_logging, dev_tools_prune_errors, **flask_run_options)[0m
[1;32m   2167[0m [38;5;28;01mif[39;00m jupyter_dash[38;5;241m.[39mactive:
[0;32m-> 2168[0m     [43mjupyter_dash[49m[38;5;241;43m.[39;49m[43mrun_app[49m[43m([49m
[1;32m   2169[0m [43m        [49m[38;5;28;43mself[39;49m[43m,[49m
[1;32m   2170[0m [43m        [49m[43mmode[49m[38;5;241;43m=[39;49m[43mjupyter_mode[49m[43m,[49m
[1;32m   2171[0m [43m        [49m[43mwidth[49m[38;5;241;43m=[39;49m[43mjupyter_width[49m[43m,[49m
[1;32m   2172[0m [43m        [49m[43mheight[49m[38;5;241;43m=[39;49m[43mjupyter_height[49m[43m,[49m
[1;32m   2173[0m [43m        [49m[43mhost[49m[38;5;241;43m=[39;49m[43mhost[49m[43m,[49m
[1;32m   2174[0m [43m        [49m[43mport[49m[38;5;241;43m=[39;49m[43mport[49m[43m,[49m
[1;32m   2175[0m [43m        [49m[43mserver_url[49m[38;5;241;43m=[39;49m[43mjupyter_server_url[49m[43m,[49m
[1;32m   2176[0m [43m    [49m[43m)[49m
[1;32m   2177[0m [38;5;28;01melse[39;00m:

File [0;32m/usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages/dash/_jupyter.py:332[0m, in [0;36mJupyterDash.run_app[0;34m(self, app, mode, width, height, host, port, server_url)[0m
[1;32m    330[0m err_q [38;5;241m=[39m queue[38;5;241m.[39mQueue()
[0;32m--> 332[0m server [38;5;241m=[39m [43mmake_server[49m[43m([49m[43mhost[49m[43m,[49m[43m [49m[43mport[49m[43m,[49m[43m [49m[43mapp[49m[38;5;241;43m.[39;49m[43mserver[49m[43m,[49m[43m [49m[43mthreaded[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m[43m [49m[43mprocesses[49m[38;5;241;43m=[39;49m[38;5;241;43m0[39;49m[43m)[49m
[1;32m    333[0m logging[38;5;241m.[39mgetLogger([38;5;124m"[39m[38;5;124mwerkzeug[39m[38;5;124m"[39m)[38;5;241m.[39msetLevel(logging[38;5;241m.[39mERROR)

File [0;32m/usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages/werkzeug/serving.py:921[0m, in [0;36mmake_server[0;34m(host, port, app, threaded, processes, request_handler, passthrough_errors, ssl_context, fd)[0m
[1;32m    920[0m [38;5;28;01mif[39;00m threaded:
[0;32m--> 921[0m     [38;5;28;01mreturn[39;00m [43mThreadedWSGIServer[49m[43m([49m
[1;32m    922[0m [43m        [49m[43mhost[49m[43m,[49m[43m [49m[43mport[49m[43m,[49m[43m [49m[43mapp[49m[43m,[49m[43m [49m[43mrequest_handler[49m[43m,[49m[43m [49m[43mpassthrough_errors[49m[43m,[49m[43m [49m[43mssl_context[49m[43m,[49m[43m [49m[43mfd[49m[38;5;241;43m=[39;49m[43mfd[49m
[1;32m    923[0m [43m    [49m[43m)[49m
[1;32m    925[0m [38;5;28;01mif[39;00m processes [38;5;241m>[39m [38;5;241m1[39m:

File [0;32m/usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages/werkzeug/serving.py:773[0m, in [0;36mBaseWSGIServer.__init__[0;34m(self, host, port, app, handler, passthrough_errors, ssl_context, fd)[0m
[1;32m    767[0m             [38;5;28mprint[39m(
[1;32m    768[0m                 [38;5;124m"[39m[38;5;124mOn macOS, try disabling the [39m[38;5;124m'[39m[38;5;124mAirPlay Receiver[39m[38;5;124m'[39m[38;5;124m service[39m[38;5;124m"[39m
[1;32m    769[0m                 [38;5;124m"[39m[38;5;124m from System Preferences -> General -> AirDrop & Handoff.[39m[38;5;124m"[39m,
[1;32m    770[0m                 file[38;5;241m=[39msys[38;5;241m.[39mstderr,
[1;32m    771[0m             )
[0;32m--> 773[0m     [43msys[49m[38;5;241;43m.[39;49m[43mexit[49m[43m([49m[38;5;241;43m1[39;49m[43m)[49m
[1;32m    774[0m [38;5;28;01mexcept[39;00m [38;5;167;01mBaseException[39;00m:

[0;31mSystemExit[0m: 1

During handling of the above exception, another exception occurred:

[0;31mAttributeError[0m                            Traceback (most recent call last)
    [0;31m[... skipping hidden 1 frame][0m

File [0;32m/usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages/IPython/core/interactiveshell.py:2145[0m, in [0;36mInteractiveShell.showtraceback[0;34m(self, exc_tuple, filename, tb_offset, exception_only, running_compiled_code)[0m
[1;32m   2142[0m [38;5;28;01mif[39;00m exception_only:
[1;32m   2143[0m     stb [38;5;241m=[39m [[38;5;124m'[39m[38;5;124mAn exception has occurred, use [39m[38;5;124m%[39m[38;5;124mtb to see [39m[38;5;124m'[39m
[1;32m   2144[0m            [38;5;124m'[39m[38;5;124mthe full traceback.[39m[38;5;130;01m\n[39;00m[38;5;124m'[39m]
[0;32m-> 2145[0m     stb[38;5;241m.[39mextend([38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mInteractiveTB[49m[38;5;241;43m.[39;49m[43mget_exception_only[49m[43m([49m[43metype[49m[43m,[49m
[1;32m   2146[0m [43m                                                     [49m[43mvalue[49m[43m)[49m)
[1;32m   2147[0m [38;5;28;01melse[39;00m:
[1;32m   2149[0m     [38;5;28;01mdef[39;00m [38;5;21mcontains_exceptiongroup[39m(val):

File [0;32m/usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages/IPython/core/ultratb.py:710[0m, in [0;36mListTB.get_exception_only[0;34m(self, etype, value)[0m
[1;32m    702[0m [38;5;28;01mdef[39;00m [38;5;21mget_exception_only[39m([38;5;28mself[39m, etype, value):
[1;32m    703[0m [38;5;250m    [39m[38;5;124;03m"""Only print the exception type and message, without a traceback.[39;00m
[1;32m    704[0m 
[1;32m    705[0m [38;5;124;03m    Parameters[39;00m
[0;32m   (...)[0m
[1;32m    708[0m [38;5;124;03m    value : exception value[39;00m
[1;32m    709[0m [38;5;124;03m    """[39;00m
[0;32m--> 710[0m     [38;5;28;01mreturn[39;00m [43mListTB[49m[38;5;241;43m.[39;49m[43mstructured_traceback[49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[43metype[49m[43m,[49m[43m [49m[43mvalue[49m[43m)[49m

File [0;32m/usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages/IPython/core/ultratb.py:568[0m, in [0;36mListTB.structured_traceback[0;34m(self, etype, evalue, etb, tb_offset, context)[0m
[1;32m    565[0m     chained_exc_ids[38;5;241m.[39madd([38;5;28mid[39m(exception[[38;5;241m1[39m]))
[1;32m    566[0m     chained_exceptions_tb_offset [38;5;241m=[39m [38;5;241m0[39m
[1;32m    567[0m     out_list [38;5;241m=[39m (
[0;32m--> 568[0m         [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mstructured_traceback[49m[43m([49m
[1;32m    569[0m [43m            [49m[43metype[49m[43m,[49m
[1;32m    570[0m [43m            [49m[43mevalue[49m[43m,[49m
[1;32m    571[0m [43m            [49m[43m([49m[43metb[49m[43m,[49m[43m [49m[43mchained_exc_ids[49m[43m)[49m[43m,[49m[43m  [49m[38;5;66;43;03m# type: ignore[39;49;00m
[1;32m    572[0m [43m            [49m[43mchained_exceptions_tb_offset[49m[43m,[49m
[1;32m    573[0m [43m            [49m[43mcontext[49m[43m,[49m
[1;32m    574[0m [43m        [49m[43m)[49m
[1;32m    575[0m         [38;5;241m+[39m chained_exception_message
[1;32m    576[0m         [38;5;241m+[39m out_list)
[1;32m    578[0m [38;5;28;01mreturn[39;00m out_list

File [0;32m/usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages/IPython/core/ultratb.py:1454[0m, in [0;36mAutoFormattedTB.structured_traceback[0;34m(self, etype, evalue, etb, tb_offset, number_of_lines_of_context)[0m
[1;32m   1452[0m [38;5;28;01melse[39;00m:
[1;32m   1453[0m     [38;5;28mself[39m[38;5;241m.[39mtb [38;5;241m=[39m etb
[0;32m-> 1454[0m [38;5;28;01mreturn[39;00m [43mFormattedTB[49m[38;5;241;43m.[39;49m[43mstructured_traceback[49m[43m([49m
[1;32m   1455[0m [43m    [49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[43metype[49m[43m,[49m[43m [49m[43mevalue[49m[43m,[49m[43m [49m[43metb[49m[43m,[49m[43m [49m[43mtb_offset[49m[43m,[49m[43m [49m[43mnumber_of_lines_of_context[49m
[1;32m   1456[0m [43m[49m[43m)[49m

File [0;32m/usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages/IPython/core/ultratb.py:1345[0m, in [0;36mFormattedTB.structured_traceback[0;34m(self, etype, value, tb, tb_offset, number_of_lines_of_context)[0m
[1;32m   1342[0m mode [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mmode
[1;32m   1343[0m [38;5;28;01mif[39;00m mode [38;5;129;01min[39;00m [38;5;28mself[39m[38;5;241m.[39mverbose_modes:
[1;32m   1344[0m     [38;5;66;03m# Verbose modes need a full traceback[39;00m
[0;32m-> 1345[0m     [38;5;28;01mreturn[39;00m [43mVerboseTB[49m[38;5;241;43m.[39;49m[43mstructured_traceback[49m[43m([49m
[1;32m   1346[0m [43m        [49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[43metype[49m[43m,[49m[43m [49m[43mvalue[49m[43m,[49m[43m [49m[43mtb[49m[43m,[49m[43m [49m[43mtb_offset[49m[43m,[49m[43m [49m[43mnumber_of_lines_of_context[49m
[1;32m   1347[0m [43m    [49m[43m)[49m
[1;32m   1348[0m [38;5;28;01melif[39;00m mode [38;5;241m==[39m [38;5;124m'[39m[38;5;124mMinimal[39m[38;5;124m'[39m:
[1;32m   1349[0m     [38;5;28;01mreturn[39;00m ListTB[38;5;241m.[39mget_exception_only([38;5;28mself[39m, etype, value)

File [0;32m/usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages/IPython/core/ultratb.py:1192[0m, in [0;36mVerboseTB.structured_traceback[0;34m(self, etype, evalue, etb, tb_offset, number_of_lines_of_context)[0m
[1;32m   1183[0m [38;5;28;01mdef[39;00m [38;5;21mstructured_traceback[39m(
[1;32m   1184[0m     [38;5;28mself[39m,
[1;32m   1185[0m     etype: [38;5;28mtype[39m,
[0;32m   (...)[0m
[1;32m   1189[0m     number_of_lines_of_context: [38;5;28mint[39m [38;5;241m=[39m [38;5;241m5[39m,
[1;32m   1190[0m ):
[1;32m   1191[0m [38;5;250m    [39m[38;5;124;03m"""Return a nice text document describing the traceback."""[39;00m
[0;32m-> 1192[0m     formatted_exception [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mformat_exception_as_a_whole[49m[43m([49m[43metype[49m[43m,[49m[43m [49m[43mevalue[49m[43m,[49m[43m [49m[43metb[49m[43m,[49m[43m [49m[43mnumber_of_lines_of_context[49m[43m,[49m
[1;32m   1193[0m [43m                                                           [49m[43mtb_offset[49m[43m)[49m
[1;32m   1195[0m     colors [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mColors  [38;5;66;03m# just a shorthand + quicker name lookup[39;00m
[1;32m   1196[0m     colorsnormal [38;5;241m=[39m colors[38;5;241m.[39mNormal  [38;5;66;03m# used a lot[39;00m

File [0;32m/usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages/IPython/core/ultratb.py:1082[0m, in [0;36mVerboseTB.format_exception_as_a_whole[0;34m(self, etype, evalue, etb, number_of_lines_of_context, tb_offset)[0m
[1;32m   1079[0m [38;5;28;01massert[39;00m [38;5;28misinstance[39m(tb_offset, [38;5;28mint[39m)
[1;32m   1080[0m head [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mprepare_header([38;5;28mstr[39m(etype), [38;5;28mself[39m[38;5;241m.[39mlong_header)
[1;32m   1081[0m records [38;5;241m=[39m (
[0;32m-> 1082[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mget_records[49m[43m([49m[43metb[49m[43m,[49m[43m [49m[43mnumber_of_lines_of_context[49m[43m,[49m[43m [49m[43mtb_offset[49m[43m)[49m [38;5;28;01mif[39;00m etb [38;5;28;01melse[39;00m []
[1;32m   1083[0m )
[1;32m   1085[0m frames [38;5;241m=[39m []
[1;32m   1086[0m skipped [38;5;241m=[39m [38;5;241m0[39m

File [0;32m/usr/local/Caskroom/miniconda/base/envs/jupyterbook/lib/python3.10/site-packages/IPython/core/ultratb.py:1150[0m, in [0;36mVerboseTB.get_records[0;34m(self, etb, number_of_lines_of_context, tb_offset)[0m
[1;32m   1148[0m [38;5;28;01mwhile[39;00m cf [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[1;32m   1149[0m     [38;5;28;01mtry[39;00m:
[0;32m-> 1150[0m         mod [38;5;241m=[39m inspect[38;5;241m.[39mgetmodule([43mcf[49m[38;5;241;43m.[39;49m[43mtb_frame[49m)
[1;32m   1151[0m         [38;5;28;01mif[39;00m mod [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[1;32m   1152[0m             mod_name [38;5;241m=[39m mod[38;5;241m.[39m[38;5;18m__name__[39m

[0;31mAttributeError[0m: 'tuple' object has no attribute 'tb_frame'

